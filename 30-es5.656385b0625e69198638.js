function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,c=function(){};return{s:c,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,n,o=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,n=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw n}}}}function _defineProperty(e,t,c){return t in e?Object.defineProperty(e,t,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[t]=c,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var c=Object.prototype.toString.call(e).slice(8,-1);return"Object"===c&&e.constructor&&(c=e.constructor.name),"Map"===c||"Set"===c?Array.from(c):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var c=0,r=new Array(t);c<t;c++)r[c]=e[c];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var c=[],r=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(c.push(i.value),!t||c.length!==t);r=!0);}catch(s){n=!0,o=s}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var c=0;c<t.length;c++){var r=t[c];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,c){return t&&_defineProperties(e.prototype,t),c&&_defineProperties(e,c),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"4mc+":function(e,t,c){"use strict";c.d(t,"a",(function(){return h})),c.d(t,"b",(function(){return v})),c.d(t,"c",(function(){return p}));var r=c("2kYt"),n=c("EM62"),o=c("mFH5"),i=c("0Hrt"),a=c("7sjG"),s=c("5uKI");function l(e,t){if(1&e&&Object(n.lc)(0,4),2&e){var c=Object(n.Bc)();Object(n.Ic)("ngTemplateOutlet",c.utilityMenuTemplate)}}function d(e,t){1&e&&(Object(n.pc)(0,"ts-icon",5),Object(n.fd)(1,"lock_outline"),Object(n.oc)())}var u=function(e,t,c,r,n,o){return{"c-card--interaction":e,"c-card--centered":t,"c-card--aspect":c,"c-card--disabled":r,"c-card--right-spacing":n,"c-card--flat":o}},f=["*"],b=0,h=function(){var e=function(){function e(){_classCallCheck(this,e),this.uid="ts-card-".concat(b++),this._border="none",this.centeredContent=!1,this.isDisabled=!1,this.flat=!1,this._id=this.uid,this.supportsInteraction=!1,this._theme="primary"}return _createClass(e,[{key:"aspectRatio",set:function(e){var t=parseInt(e.split(":")[0],10),c=parseInt(e.split(":")[1],10);this.aspectRatioPadding="".concat((c/t*100).toFixed(2),"%")}},{key:"border",set:function(e){this._border=e||"none"},get:function(){return this._border}},{key:"id",set:function(e){this._id=e||this.uid},get:function(){return this._id}},{key:"theme",set:function(e){this._theme=e||"primary"},get:function(){return this._theme}},{key:"borderClass",get:function(){return this.border&&"none"!==this.border?"c-card--border-".concat(this.border):""}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(n.dc)({type:e,selectors:[["ts-card"]],hostAttrs:[1,"ts-card"],inputs:{aspectRatio:"aspectRatio",border:"border",centeredContent:"centeredContent",isDisabled:"isDisabled",flat:"flat",id:"id",supportsInteraction:"supportsInteraction",theme:"theme",utilityMenuTemplate:"utilityMenuTemplate"},exportAs:["tsCard"],ngContentSelectors:f,decls:5,vars:18,consts:[[3,"ngClass"],["mat-ripple","",1,"c-card__inner",3,"matRippleDisabled"],[3,"ngTemplateOutlet",4,"ngIf"],["class","c-card__lock qa-card-lock",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"c-card__lock","qa-card-lock"]],template:function(e,t){1&e&&(Object(n.Hc)(),Object(n.pc)(0,"div",0),Object(n.pc)(1,"div",1),Object(n.Gc)(2),Object(n.oc)(),Object(n.dd)(3,l,1,1,"ng-container",2),Object(n.dd)(4,d,2,0,"ts-icon",3),Object(n.oc)()),2&e&&(Object(n.Zb)("c-card qa-card ",t.borderClass," c-card--",t.theme,""),Object(n.cd)("padding-top",t.aspectRatioPadding),Object(n.Ic)("ngClass",Object(n.Pc)(11,u,t.supportsInteraction,t.centeredContent,t.aspectRatioPadding,t.isDisabled,t.utilityMenuTemplate||t.isDisabled,t.flat)),Object(n.Wb)("id",t.id),Object(n.Vb)(1),Object(n.Ic)("matRippleDisabled",!t.supportsInteraction||t.isDisabled),Object(n.Vb)(2),Object(n.Ic)("ngIf",t.utilityMenuTemplate),Object(n.Vb)(1),Object(n.Ic)("ngIf",t.isDisabled&&!t.utilityMenuTemplate))},directives:[r.q,o.o,r.t,r.A,i.a],styles:[".ts-card{display:flex;flex-flow:row nowrap}.ts-card :not(.mat-form-field-label-wrapper){box-sizing:border-box}.ts-card h1,.ts-card h2,.ts-card h3,.ts-card h4,.ts-card h5,.ts-card p{margin:unset}.ts-card .c-card{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;letter-spacing:.01em;font-weight:400;background-color:#fafafa;position:relative;transition:height .2s;width:100%}.ts-card .c-card:not(.c-button):not(.c-input):not(.c-select):not(.ts-checkbox){line-height:20px}.ts-card .c-card:not(.c-card--aspect),.ts-card .c-card:not(.c-card--interaction){align-items:stretch;display:flex;flex-direction:row;justify-content:center}.c-card .c-card__inner{min-height:calc(100% - 48px);padding:24px;vertical-align:top;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);position:relative;width:100%}.c-card .c-card__inner .c-card__title{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:20px;font-weight:500;letter-spacing:.005em}.c-card .c-card__inner .c-card__title-accent-border{border-left:2px solid #00538a;padding-left:8px}.c-card .c-card__inner .c-card__title-accent-border[theme=accent]{border-left-color:#2f854d}.c-card .c-card__inner .c-card__title-accent-border[theme=warn]{border-left-color:#c8604d}.c-card--interaction:not(.c-card--disabled) .c-card__inner{min-height:calc(100% - 48px);padding:24px;vertical-align:top;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);transition:box-shadow 250ms cubic-bezier(.4,0,.2,1);cursor:pointer}.c-card--interaction:not(.c-card--disabled) .c-card__inner:hover{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.c-card--interaction:not(.c-card--disabled) .c-card__inner .c-card__title{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:20px;font-weight:500;letter-spacing:.005em}.c-card--centered .c-card__inner{align-items:center;display:flex;justify-content:center}.c-card--aspect .c-card__inner{bottom:0;left:0;position:absolute;right:0;top:0}.c-card--disabled .c-card__inner{opacity:.5}.c-card--disabled .c-menu{opacity:.3;pointer-events:none}.c-card--disabled .c-card__lock{color:#999;position:absolute;right:24px;top:calc(24px - 2px);transform:scale(.7)}.c-card--right-spacing .c-card__inner{padding-right:56px}.c-card--flat>.c-card__inner{border:1px solid #cecdd1;box-shadow:none}.c-card--border-bottom.c-card--primary .c-card__inner{border-bottom:2px solid #00538a}.c-card--border-bottom.c-card--accent .c-card__inner{border-bottom:2px solid #2f854d}.c-card--border-bottom.c-card--warn .c-card__inner{border-bottom:2px solid #c8604d}.c-card--border-left.c-card--primary .c-card__inner{border-left:2px solid #00538a}.c-card--border-left.c-card--accent .c-card__inner{border-left:2px solid #2f854d}.c-card--border-left.c-card--warn .c-card__inner{border-left:2px solid #c8604d}.c-card--border-right.c-card--primary .c-card__inner{border-right:2px solid #00538a}.c-card--border-right.c-card--accent .c-card__inner{border-right:2px solid #2f854d}.c-card--border-right.c-card--warn .c-card__inner{border-right:2px solid #c8604d}.c-card--border-top.c-card--primary .c-card__inner{border-top:2px solid #00538a}.c-card--border-top.c-card--accent .c-card__inner{border-top:2px solid #2f854d}.c-card--border-top.c-card--warn .c-card__inner{border-top:2px solid #c8604d}.c-card__inner .ts-table~.ts-loading-overlay .c-loading-overlay{left:-24px;right:-24px}"],encapsulation:2,changeDetection:0}),e}(),p=function(){var e=function(){function e(t){if(_classCallCheck(this,e),this.theme="primary",this.tsCardTitle="c-card__title",!(t instanceof h)&&Object(n.ob)())throw new s.c("The 'tsCardTitle' directive must be inside a <ts-card> component.")}return _createClass(e,[{key:"tsTitleAccentBorder",set:function(e){Object(a.b)(e)&&(this.tsCardTitle="".concat(this.tsCardTitle," c-card__title-accent-border"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Object(n.jc)(h,13))},e.\u0275dir=Object(n.ec)({type:e,selectors:[["","tsCardTitle",""]],hostVars:2,hostBindings:function(e,t){2&e&&Object(n.Xb)(t.tsCardTitle)},inputs:{tsTitleAccentBorder:"tsTitleAccentBorder",theme:"theme"}}),e}(),v=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=Object(n.hc)({type:e}),e.\u0275inj=Object(n.gc)({factory:function(t){return new(t||e)},imports:[[r.c,o.p,i.b]]}),e}()},iRLe:function(e,t,c){"use strict";c.r(t),c.d(t,"CSVEntryModule",(function(){return G}));var r=c("2kYt"),n=c("nIj0"),o=c("4mc+"),i=c("EM62"),a=c("40Bj"),s=c("wK4c"),l=c("0Hrt"),d=c("NDKv"),u=c("BRos"),f=c("AW5y"),b=c("7sjG"),h=c("HRj5"),p=c("/Gcv"),v=c("5uKI"),y=c("mWib"),m=c("qFEQ");function g(e,t){if(1&e&&(Object(i.pc)(0,"div",23),Object(i.pc)(1,"span",22),Object(i.fd)(2),Object(i.oc)(),Object(i.oc)()),2&e){var c=t.$implicit,r=t.index;Object(i.ac)("c-csv-entry__column-id--invalid",c.invalid),Object(i.Wb)("id","csv-row-id-"+(r+1)),Object(i.Vb)(2),Object(i.hd)(" ",(null==c.controls||null==c.controls.recordId?null:c.controls.recordId.value)-0+1," ")}}function _(e,t){if(1&e){var c=Object(i.qc)();Object(i.pc)(0,"input",24),Object(i.xc)("paste",(function(e){return Object(i.Vc)(c),Object(i.Bc)().onPaste(e,!0)}))("keydown.enter",(function(){Object(i.Vc)(c);var e=t.index,r=Object(i.Bc)();return r.selectCellInNextRow(r.createId(-1,e))}))("keydown.tab",(function(e){Object(i.Vc)(c);var r=t.index,n=Object(i.Bc)();return n.selectAdjacentCell(e,n.createId(-1,r))}))("keydown.shift.tab",(function(e){Object(i.Vc)(c);var r=t.index,n=Object(i.Bc)();return n.selectAdjacentCell(e,n.createId(-1,r),!0)})),Object(i.oc)()}if(2&e){var r=t.index,n=Object(i.Bc)();Object(i.Kc)("title","Header, Column: ",n.getHeaderCellName(r)||r+1,""),Object(i.Ic)("readonly",n.columnHeaders&&n.columnHeaders[r])("formControlName",r),Object(i.Wb)("id",n.createId(-1,r))}}function j(e,t){if(1&e){var c=Object(i.qc)();Object(i.pc)(0,"input",28),Object(i.xc)("paste",(function(e){return Object(i.Vc)(c),Object(i.Bc)(2).onPaste(e)}))("keydown.enter",(function(){Object(i.Vc)(c);var e=t.index,r=Object(i.Bc)().index,n=Object(i.Bc)();return n.selectCellInNextRow(n.createId(r,e))}))("keydown.shift.enter",(function(){Object(i.Vc)(c);var e=t.index,r=Object(i.Bc)().index,n=Object(i.Bc)();return n.selectCellInNextRow(n.createId(r,e),!0)}))("keyup",(function(){return Object(i.Vc)(c),Object(i.Bc)(2).updateErrors()}))("keydown.tab",(function(e){Object(i.Vc)(c);var r=t.index,n=Object(i.Bc)().index,o=Object(i.Bc)();return o.selectAdjacentCell(e,o.createId(n,r))}))("keydown.shift.tab",(function(e){Object(i.Vc)(c);var r=t.index,n=Object(i.Bc)().index,o=Object(i.Bc)();return o.selectAdjacentCell(e,o.createId(n,r),!0)})),Object(i.oc)()}if(2&e){var r=t.$implicit,n=t.index,o=Object(i.Bc)(),a=o.$implicit,s=o.index,l=Object(i.Bc)();Object(i.ac)("c-csv-entry__input--invalid",r.invalid),Object(i.Lc)("title","Row: ",(null==a.controls||null==a.controls.recordId?null:a.controls.recordId.value)+1,", Column: ",l.getHeaderCellName(n)||n+1,""),Object(i.Ic)("formControlName",n),Object(i.Wb)("id",l.createId(s,n))}}function O(e,t){if(1&e&&(Object(i.pc)(0,"div",25),Object(i.pc)(1,"div",26),Object(i.dd)(2,j,1,6,"input",27),Object(i.oc)(),Object(i.oc)()),2&e){var c,r=t.$implicit,n=t.index,o=null==(c=Object(i.Bc)().getColumns(r))?null:c.controls;Object(i.Ic)("formGroupName",n),Object(i.Vb)(2),Object(i.Ic)("ngForOf",o)}}function w(e,t){if(1&e){var c=Object(i.qc)();Object(i.pc)(0,"ts-icon-button",29),Object(i.xc)("click",(function(){Object(i.Vc)(c);var e=t.index;return Object(i.Bc)().deleteRow(e)})),Object(i.fd)(1,"delete_forever"),Object(i.oc)()}if(2&e){var r=t.index;Object(i.Wb)("id","csv-delete-"+(r+1))("title","Delete row "+(r+1))}}function x(e,t){if(1&e&&Object(i.kc)(0,"div",30),2&e){var c=t.$implicit;Object(i.Ic)("innerHTML",c,i.Wc)}}function C(e,t){if(1&e&&(Object(i.pc)(0,"div",31),Object(i.fd)(1),Object(i.oc)()),2&e){var c=Object(i.Bc)();Object(i.Vb)(1),Object(i.gd)(c.tooManyRowsMessage)}}var k,I,R,A,H,V=["*"],F=0,T=((I=function(){function e(t,c,r){_classCallCheck(this,e),this.formBuilder=t,this.changeDetectorRef=c,this.documentService=r,this.originalColumnCount=2,this.uid="ts-csv-entry-".concat(F++),this.fakeRowHeight="35px",this.layoutGap=p.a.small[0],this.tooManyRowsMessage=null,this.records=[],this.recordsForm=this.formBuilder.group({headers:this.formBuilder.array([]),records:this.formBuilder.array([])}),this.allErrors=null,this._columnCount=2,this._columnValidators=[],this.footerDirection="ltr",this.fullWidth=!1,this._id=this.uid,this._maxRows=2e3,this.outputFormat="tsv",this._rowCount=4,this.blobGenerated=new i.u}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.addRows(this.rowCount,this.columnCount),this.addHeaders(this.columnCount,this.columnHeaders),this.originalColumnCount=this.columnCount,this.recordsForm.valueChanges.pipe(Object(y.a)(1),Object(h.j)(this)).subscribe((function(t){var c=e.generateBlob(t);e.blobGenerated.emit(c)}))}},{key:"ngOnDestroy",value:function(){}},{key:"addRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.columnCount,arguments.length>2?arguments[2]:void 0),c=arguments.length>3?arguments[3]:void 0;if(this.rows.length+e>this.maxRows){var r=(1===e?2:e)-(this.rows.length+e-this.maxRows);this.tooManyRowsMessage="Adding ".concat(r," row").concat(r>1?"s":""," would exceed the maximum rows allowed (").concat(this.maxRows,").")}else{this.tooManyRowsMessage&&(this.tooManyRowsMessage=null);for(var n=0;n<e;n+=1){var o=(void 0===c?this.rowCount:c)+n,i=this.createRow(this.rows.length,t?t[n]:null);void 0!==c&&c>=0?this.rows.insert(o,i):this.rows.push(i)}}}},{key:"getColumns",value:function(e){return e.get("columns")}},{key:"updateAllRowIds",value:function(){for(var e=0;e<this.rows.length;e+=1){var t=this.rows.controls[e];t&&t.controls.recordId.setValue(e)}}},{key:"onPaste",value:function(t,c){var r,n=null===(r=t.clipboardData)||void 0===r?void 0:r.getData("Text");if(n&&!(n.indexOf("\n")<0&&n.indexOf("\t")<0)){c=Object(b.b)(c);var o=parseInt(t.target.id.split("X")[0].split("_")[2],10),i=e.splitContent(n,c),a=i.rows.length;if(c)this.clearAllRows(),this.clearHeaderCells(),this.addHeaders(i.headers.length,this.columnHeaders||i.headers),this.columnCount=i.headers.length,this.addRows(a,i.headers.length,i.rows);else{var s=i.rows[0].length;s>this.columnCount&&(e.addColumnsToRows(this.rows,this.headerCells,s-this.columnCount),this.columnCount=s),this.deleteRow(o),this.addRows(a,i.rows.length,i.rows,o)}this.updateAllRowIds(),this.updateErrors(),this.changeDetectorRef.detectChanges()}}},{key:"updateErrors",value:function(){this.allErrors=this.collectErrors()}},{key:"getHeaderCellName",value:function(e){return this.headerCells&&this.headerCells.controls[e]?this.headerCells.controls[e].value:""}},{key:"onScroll",value:function(e){if(e){var t=e.deltaX<0?"right":"left",c=e.target;if(c){var r=c.form.scrollWidth-(parseInt(c.form.offsetWidth,10)+2)-c.form.scrollLeft;0!==e.deltaX&&("right"===t&&c.form.scrollLeft<1||"left"===t&&r<1)&&e.preventDefault()}}}},{key:"selectCellInNextRow",value:function(e,t){if(e){var c=_slicedToArray(e.split("X"),2),r=c[0],n=c[1],o=r.split("_")[2],i=n.split("_")[1],a="".concat(this.uid,"_r_").concat(parseInt(o,10)+(t?-1:1),"Xc_").concat(i),s=this.documentService.document.querySelector("#".concat(a));s?s.focus():(this.addRows(),this.changeDetectorRef.detectChanges(),this.selectCellInNextRow(e))}}},{key:"selectAdjacentCell",value:function(e,t,c){e.preventDefault(),c=Object(b.b)(c);var r,n=_slicedToArray(t.split("X"),2),o=n[0],i=n[1],a=parseInt(o.split("_")[2],10),s=parseInt(i.split("_")[1],10),l=a;c?0===s?(r=this.columnCount-1,l+=-1):r=s-1:s===this.columnCount-1?(r=0,l+=1):r=s+1;var d=this.documentService.document.querySelector("#".concat("".concat(this.uid,"_r_").concat(l,"Xc_").concat(r)));d&&d.focus()}},{key:"createId",value:function(e,t){return"".concat(this.uid,"_r_").concat(e,"Xc_").concat(t)}},{key:"collectErrors",value:function(){var e=this.recordsForm.get("records");if(e){var t=this.getFormErrors(e);return t?Object.keys(t).map((function(e){return _defineProperty({control:e},e,t[e].filter((function(e,t,c){return c.indexOf(e)===t})))})):null}return null}},{key:"deleteRow",value:function(e){null==e||e<0||(this.rows.removeAt(e),this.updateAllRowIds(),this.updateErrors())}},{key:"resetTable",value:function(){this.clearAllRows(),this.clearHeaderCells(),this.columnCount=this.originalColumnCount,this.addRows(this.rowCount,this.columnCount),this.addHeaders(this.columnCount,this.columnHeaders),this.allErrors=null}},{key:"getFormErrors",value:function(e){var t={};return this.getAllErrors(e,t),t}},{key:"getAllErrors",value:function(e,t){for(var c=Object.keys(e.controls),r=0;r<c.length;r+=1){var o=e.get(c[r]);if(o){var i=o instanceof n.j||o instanceof n.d?this.getAllErrors(o,t):o.errors;if(i)for(var a=o.parent.parent.controls,s=a.recordId?a.recordId.value:void 0,l=Object.keys(i),d=0;d<l.length;d+=1){var u=l[d],f=i[l[d]];"boolean"==typeof f&&(f={valid:!1}),void 0!==s&&(f.rowId=s),t[u]?t[u].push(f):t[u]=[f]}}}}},{key:"clearAllRows",value:function(){this.recordsForm.setControl("records",this.formBuilder.array([]))}},{key:"clearHeaderCells",value:function(){this.recordsForm.setControl("headers",this.formBuilder.array([]))}},{key:"addHeaders",value:function(e,t){for(var c=0;c<e;c+=1){var r=t&&t[c]?t[c]:null,o=r?new n.g(r):new n.g;this.headerCells.setControl(c,o)}}},{key:"createRow",value:function(e,t){return this.formBuilder.group({recordId:new n.g(e),columns:this.formBuilder.array(this.createColumns(this.columnCount,t))})}},{key:"createColumns",value:function(e,t){for(var c=[],r=0;r<e;r+=1){var o=t&&t[r]?t[r]:null;o&&(o=Object(v.e)(o)),c.push(new n.g(o,this.columnValidators?this.columnValidators[r]:null))}return c}},{key:"generateBlob",value:function(e){var t="data:text/csv;charset=utf-8,"+"".concat(e.headers.join("\t"),"\r\n")+"".concat(e.records.map((function(e){return e.columns.map((function(e){return e?'"'.concat(e.replace(/"/g,'""'),'"'):""})).join("\t")})).join("\r\n"),"\r\n");return"csv"===this.outputFormat&&(t=JSON.stringify(t).replace(/\\t/g,",")),new Blob([t],{type:"text/csv"})}},{key:"headerCells",get:function(){return this.recordsForm.get("headers")}},{key:"rows",get:function(){return this.recordsForm.get("records")}},{key:"columnCount",set:function(e){this._columnCount=Object(b.d)(e,2)},get:function(){return this._columnCount}},{key:"columnHeaders",set:function(e){this._columnHeaders=e,this.clearHeaderCells(),this.addHeaders(this.columnCount,this.columnHeaders)},get:function(){return this._columnHeaders}},{key:"columnValidators",set:function(e){e&&(this._columnValidators=e)},get:function(){return this._columnValidators}},{key:"id",set:function(e){this._id=e||this.uid},get:function(){return this._id}},{key:"maxRows",set:function(e){this._maxRows=Object(b.d)(e,2e3)},get:function(){return this._maxRows}},{key:"rowCount",set:function(e){this._rowCount=Object(b.d)(e,4)},get:function(){return this._rowCount}},{key:"validationMessages",get:function(){if(this.allErrors){var e,t=[],c=_createForOfIteratorHelper(this.allErrors);try{for(c.s();!(e=c.n()).done;){var r,n=e.value,o=n.control,i=_createForOfIteratorHelper(n[o]);try{for(i.s();!(r=i.n()).done;){var a=r.value,s="";s+="<b>Row ".concat(parseInt(a.rowId,10)+1,":</b> "),"url"===o&&(s+='"'.concat(a.actual.length>20?"".concat(a.actual.slice(0,20),"..."):a.actual,'" is not a valid URL.')),"required"===o&&(s+="Content is required."),t.push(s)}}catch(d){i.e(d)}finally{i.f()}}}catch(d){c.e(d)}finally{c.f()}if(t.length>6){var l=t.length-6;t.length=6,t.push("and ".concat(l," more errors..."))}return t.length>0?t:void 0}}}],[{key:"addColumnsToRows",value:function(e,t,c){for(var r=0;r<e.length;r+=1){var o=e.controls[r];if(o)for(var i=o.controls.columns,a=0;a<c;a+=1)i.controls.push(new n.g)}for(var s=0;s<c;s+=1)t.controls.push(new n.g)}},{key:"splitContent",value:function(e,t){var c={headers:void 0,rows:void 0},r=e.split("\n");return t?(c.headers=r[0].split("\t"),c.rows=r.slice(1,r.length).map((function(e){return e.split("\t")}))):c.rows=r.slice(0,r.length).map((function(e){return e.split("\t")})),c}}]),e}()).\u0275fac=function(e){return new(e||I)(Object(i.jc)(n.f),Object(i.jc)(i.j),Object(i.jc)(f.a))},I.\u0275cmp=Object(i.dc)({type:I,selectors:[["ts-csv-entry"]],hostAttrs:[1,"ts-csv-entry"],hostVars:3,hostBindings:function(e,t){2&e&&(Object(i.Wb)("id",t.id),Object(i.ac)("c-csv-entry--full-width",t.fullWidth))},inputs:{columnCount:"columnCount",columnHeaders:"columnHeaders",columnValidators:"columnValidators",footerDirection:"footerDirection",fullWidth:"fullWidth",id:"id",maxRows:"maxRows",outputFormat:"outputFormat",rowCount:"rowCount"},outputs:{blobGenerated:"blobGenerated"},exportAs:["tsCSVEntry"],ngContentSelectors:V,decls:32,vars:18,consts:[[1,"c-csv-entry","qa-csv-entry"],[1,"c-csv-entry__info","qa-csv-entry-info"],[1,"c-csv-entry__scroll"],["fxLayout","row"],["fxLayout","column"],["fxFlex","0 0 auto"],["class","c-csv-entry__column-id","fxFlex","0 0 auto","fxLayout","row","fxLayoutAlign","center center",3,"c-csv-entry__column-id--invalid",4,"ngFor","ngForOf"],["fxFlex","",1,"c-csv-entry__form",3,"formGroup","mousewheel"],["form",""],["formArrayName","headers",1,"c-csv-entry__row","c-csv-entry__row--header","qa-csv-entry-header-row"],["class","c-csv-entry__input c-csv-entry__input--header qa-csv-entry-header-cell","type","text",3,"title","readonly","formControlName","paste","keydown.enter","keydown.tab","keydown.shift.tab",4,"ngFor","ngForOf"],["formArrayName","records"],["class","c-csv-entry__row qa-csv-entry-row",3,"formGroupName",4,"ngFor","ngForOf"],["class","c-csv-entry__delete qa-csv-entry-delete","fxFlex","noshrink",3,"click",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start stretch",1,"c-csv-entry__messages",3,"fxLayoutGap"],["fxLayout","column","fxLayoutAlign","center end"],["class","c-csv-entry__message qa-csv-entry-message",3,"innerHTML",4,"ngFor","ngForOf"],["class","c-csv-entry__message qa-csv-entry-message",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center",3,"dir","fxLayoutGap"],["dir","ltr","fxLayoutGap","1em"],["id","ts-csv-reset","format","hollow","theme","warn",1,"qa-csv-entry-reset",3,"clicked"],["id","ts-csv-add-row","format","hollow",1,"qa-csv-entry-add-row",3,"clicked"],["fxFlex",""],["fxFlex","0 0 auto","fxLayout","row","fxLayoutAlign","center center",1,"c-csv-entry__column-id"],["type","text",1,"c-csv-entry__input","c-csv-entry__input--header","qa-csv-entry-header-cell",3,"title","readonly","formControlName","paste","keydown.enter","keydown.tab","keydown.shift.tab"],[1,"c-csv-entry__row","qa-csv-entry-row",3,"formGroupName"],["formArrayName","columns"],["class","c-csv-entry__input qa-csv-entry-cell","type","text",3,"c-csv-entry__input--invalid","title","formControlName","paste","keydown.enter","keydown.shift.enter","keyup","keydown.tab","keydown.shift.tab",4,"ngFor","ngForOf"],["type","text",1,"c-csv-entry__input","qa-csv-entry-cell",3,"title","formControlName","paste","keydown.enter","keydown.shift.enter","keyup","keydown.tab","keydown.shift.tab"],["fxFlex","noshrink",1,"c-csv-entry__delete","qa-csv-entry-delete",3,"click"],[1,"c-csv-entry__message","qa-csv-entry-message",3,"innerHTML"],[1,"c-csv-entry__message","qa-csv-entry-message"]],template:function(e,t){1&e&&(Object(i.Hc)(),Object(i.pc)(0,"div",0),Object(i.pc)(1,"div",1),Object(i.fd)(2),Object(i.kc)(3,"br"),Object(i.fd)(4),Object(i.oc)(),Object(i.pc)(5,"div",2),Object(i.pc)(6,"div",3),Object(i.pc)(7,"div",4),Object(i.kc)(8,"div",5),Object(i.dd)(9,g,3,4,"div",6),Object(i.oc)(),Object(i.pc)(10,"form",7,8),Object(i.xc)("mousewheel",(function(e){return t.onScroll(e)})),Object(i.pc)(12,"div",9),Object(i.dd)(13,_,1,4,"input",10),Object(i.oc)(),Object(i.pc)(14,"div",11),Object(i.dd)(15,O,3,2,"div",12),Object(i.oc)(),Object(i.oc)(),Object(i.pc)(16,"div",4),Object(i.kc)(17,"div",5),Object(i.dd)(18,w,2,2,"ts-icon-button",13),Object(i.oc)(),Object(i.oc)(),Object(i.oc)(),Object(i.pc)(19,"div",14),Object(i.pc)(20,"div",15),Object(i.dd)(21,x,1,1,"div",16),Object(i.dd)(22,C,2,1,"div",17),Object(i.oc)(),Object(i.pc)(23,"div",18),Object(i.pc)(24,"div",19),Object(i.pc)(25,"ts-button",20),Object(i.xc)("clicked",(function(){return t.resetTable()})),Object(i.fd)(26,"Reset Table"),Object(i.oc)(),Object(i.pc)(27,"ts-button",21),Object(i.xc)("clicked",(function(){return t.addRows()})),Object(i.fd)(28,"Add Row"),Object(i.oc)(),Object(i.oc)(),Object(i.kc)(29,"span",22),Object(i.pc)(30,"div"),Object(i.Gc)(31),Object(i.oc)(),Object(i.oc)(),Object(i.oc)(),Object(i.oc)()),2&e&&(Object(i.Vb)(2),Object(i.id)(" ",t.rows.length," row",1===t.rows.length?"":"s"," "),Object(i.Vb)(2),Object(i.id)(" ",t.columnCount," column",1===t.columnCount?"":"s"," "),Object(i.Vb)(4),Object(i.cd)("height",t.fakeRowHeight),Object(i.Vb)(1),Object(i.Ic)("ngForOf",null==t.rows?null:t.rows.controls),Object(i.Vb)(1),Object(i.Ic)("formGroup",t.recordsForm),Object(i.Vb)(3),Object(i.Ic)("ngForOf",null==t.headerCells?null:t.headerCells.controls),Object(i.Vb)(2),Object(i.Ic)("ngForOf",null==t.rows?null:t.rows.controls),Object(i.Vb)(2),Object(i.cd)("height",t.fakeRowHeight),Object(i.Vb)(1),Object(i.Ic)("ngForOf",null==t.rows?null:t.rows.controls),Object(i.Vb)(1),Object(i.Ic)("fxLayoutGap",t.layoutGap),Object(i.Vb)(2),Object(i.Ic)("ngForOf",t.validationMessages),Object(i.Vb)(1),Object(i.Ic)("ngIf",t.tooManyRowsMessage),Object(i.Vb)(1),Object(i.Ic)("dir",t.footerDirection)("fxLayoutGap",t.layoutGap))},directives:[m.f,m.b,r.s,n.D,n.r,n.k,n.e,m.e,m.g,r.t,s.a,n.c,n.q,n.i,n.l,d.a],styles:[".ts-csv-entry{display:inline-block;font-size:16px;max-width:100%}.ts-csv-entry.c-csv-entry--full-width{display:block;width:100%}.ts-csv-entry.c-csv-entry--full-width .c-csv-entry__row{display:block}.ts-csv-entry.c-csv-entry--full-width .c-csv-entry__input{width:100%}.c-csv-entry{--csv-row-height:39px;--csv-cell-padding:8px;--csv-external-row-height:35px}.c-csv-entry .c-csv-entry__scroll{max-height:28.5em;overflow-x:-moz-hidden-unscrollable;overflow-y:auto}.c-csv-entry .c-csv-entry__info{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;letter-spacing:.02em;line-height:1.2em;margin-bottom:4px;margin-right:40px;text-align:right}.c-csv-entry .c-csv-entry__form{border:1px solid #cecdd1;overflow-x:auto}.c-csv-entry .c-csv-entry__row{display:table-row;white-space:nowrap}.c-csv-entry .c-csv-entry__input{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border:1px solid #cecdd1;display:table-cell;font-size:inherit;min-width:72px;padding:var(--csv-cell-padding)}.c-csv-entry .c-csv-entry__input+.c-csv-entry__input{border-left-width:0}.c-csv-entry .c-csv-entry__input:first-of-type{border-left:0}.c-csv-entry .c-csv-entry__input:last-of-type{border-right:0}.c-csv-entry .c-csv-entry__input:focus{background-color:#d3eaf9}.c-csv-entry .c-csv-entry__input--header{border-bottom-width:3px;border-top:0}.c-csv-entry .c-csv-entry__input--invalid{color:#c8604d}.c-csv-entry .c-csv-entry__delete{max-height:var(--csv-external-row-height)}.c-csv-entry .c-csv-entry__delete .ts-icon-button{color:#cecdd1}.c-csv-entry .c-csv-entry__column-id{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;letter-spacing:.02em;color:#cecdd1;max-height:var(--csv-external-row-height);padding:var(--csv-cell-padding)}.c-csv-entry .c-csv-entry__column-id--invalid{color:#c8604d;font-weight:400}.c-csv-entry .c-csv-entry__messages{font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:75%;font-weight:400;letter-spacing:.01em;color:#c8604d;line-height:1.2em;margin-left:15px;margin-right:40px;padding-top:4px}.c-csv-entry__row:not(.c-csv-entry__row--header):not(:last-child) .c-csv-entry__input{border-bottom-width:0}"],encapsulation:2,changeDetection:0}),I),B=((k=function e(){_classCallCheck(this,e)}).\u0275mod=Object(i.hc)({type:k}),k.\u0275inj=Object(i.gc)({factory:function(e){return new(e||k)},imports:[[r.c,a.a,n.y,s.b,d.b,l.b,u.b]]}),k),M=c("cCIM"),D=c("sEIs"),L=function(){return["foo","bar"]},q=function(){return["Full Width"]},S=[{path:"",component:(R=function(){function e(t){_classCallCheck(this,e),this.validatorsService=t,this.validators=[n.B.required,this.validatorsService.url()],this.footerDirection="ltr"}return _createClass(e,[{key:"file",value:function(e){console.log("DEMO: Got file from CSV entry: ",e),this.blob=e}},{key:"generateFile",value:function(){this.myFile=new File([this.blob],"testCsv"),function(e,t){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,"test");else{var c=document.createElement("a");document.body.appendChild(c);var r=window.URL.createObjectURL(e);c.href=r,c.download="test",c.click(),setTimeout((function(){window.URL.revokeObjectURL(r),document.body.removeChild(c)}),0)}}(this.blob)}}]),e}(),R.\u0275fac=function(e){return new(e||R)(i.jc(M.b))},R.\u0275cmp=i.dc({type:R,selectors:[["demo-csv-entry"]],decls:25,vars:10,consts:[["tsVerticalSpacing",""],["type","radio","name","direction","value","ltr",3,"ngModel","ngModelChange"],["type","radio","name","direction","value","rtl",3,"ngModel","ngModelChange"],["tsVerticalSpacing","",2,"max-width","80%"],[3,"columnValidators","columnHeaders","footerDirection","blobGenerated"],[3,"click"],["fxLayout","row"],["columnCount","1",3,"columnValidators","columnHeaders","fullWidth","blobGenerated"]],template:function(e,t){1&e&&(i.pc(0,"ts-card",0),i.pc(1,"h3",0),i.fd(2,"CSV Entry"),i.oc(),i.pc(3,"div"),i.fd(4," Footer direction: "),i.pc(5,"ul"),i.pc(6,"li"),i.pc(7,"label"),i.fd(8," ltr "),i.pc(9,"input",1),i.xc("ngModelChange",(function(e){return t.footerDirection=e})),i.oc(),i.oc(),i.oc(),i.pc(10,"li"),i.pc(11,"label"),i.fd(12," rtl "),i.pc(13,"input",2),i.xc("ngModelChange",(function(e){return t.footerDirection=e})),i.oc(),i.oc(),i.oc(),i.oc(),i.oc(),i.pc(14,"div",3),i.pc(15,"ts-csv-entry",4),i.xc("blobGenerated",(function(e){return t.file(e)})),i.pc(16,"button"),i.fd(17,"My Custom Content!"),i.oc(),i.oc(),i.oc(),i.pc(18,"button",5),i.xc("click",(function(){return t.generateFile()})),i.fd(19,"Generate file & download"),i.oc(),i.oc(),i.pc(20,"ts-card",0),i.pc(21,"h3",0),i.fd(22,"CSV Full Width Entry"),i.oc(),i.pc(23,"div",6),i.pc(24,"ts-csv-entry",7),i.xc("blobGenerated",(function(e){return t.file(e)})),i.oc(),i.oc(),i.oc()),2&e&&(i.Vb(9),i.Ic("ngModel",t.footerDirection),i.Vb(4),i.Ic("ngModel",t.footerDirection),i.Vb(2),i.Ic("columnValidators",t.validators)("columnHeaders",i.Mc(8,L))("footerDirection",t.footerDirection),i.Vb(9),i.Ic("columnValidators",t.validators)("columnHeaders",i.Mc(9,q))("fullWidth",!0))},directives:[o.a,p.c,n.x,n.c,n.q,n.t,T],encapsulation:2}),R)}],E=((H=function e(){_classCallCheck(this,e)}).\u0275mod=i.hc({type:H}),H.\u0275inj=i.gc({factory:function(e){return new(e||H)},imports:[[D.f.forChild(S)],D.f]}),H),G=((A=function e(){_classCallCheck(this,e)}).\u0275mod=i.hc({type:A}),A.\u0275inj=i.gc({factory:function(e){return new(e||A)},imports:[[r.c,E,n.m,o.b,B,p.b,M.a]]}),A)}}]);